const o=document.querySelector(".player"),c=document.querySelector(".photo"),n=c.getContext("2d"),i=document.querySelector(".strip"),u=document.querySelector(".snap"),f=document.querySelector(".btn_take"),g=document.querySelectorAll(".btn_filter");let r=[],m="normal";const v=()=>{navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(t=>{o.srcObject=t,o.play()}).catch(t=>console.error("Oh no!",t))},b=()=>{const{videoWidth:t,videoHeight:a}=o;return c.width=t,c.height=a,setInterval(()=>{n.drawImage(o,0,0,t,a),r=n.getImageData(0,0,t,a),r=E(r);let e=[];switch(m){case"normal":n.globalAlpha=1,n.putImageData(r,0,0);break;case"red":e=k(r),n.putImageData(e,0,0);break;case"green":e=D(r),n.putImageData(e,0,0);break;case"ghost":n.globalAlpha=.1,n.putImageData(r,0,0);break;default:n.putImageData(r,0,0)}},16)},y=()=>{u.currentTime=0,u.play();const t=c.toDataURL("image/jpeg"),a=document.createElement("a");a.href=t,a.setAttribute("download","Photo web fun"),a.innerHTML=`<img src="${t}" alt="hands Awesome" />`,i.insertBefore(a,i.firstChild)},k=t=>{for(let a=0;a<t.data.length;a+=4)t.data[a+0]=t.data[a+0]+100,t.data[a+1]=t.data[a+1]-50,t.data[a+2]=t.data[a+2]*.5;return t},D=t=>{for(let a=0;a<t.data.length;a+=4)t.data[a-150]=t.data[a+0],t.data[a+100]=t.data[a+1],t.data[a-150]=t.data[a+2];return t},E=t=>{const a={};[...document.querySelectorAll(".rgb input")].forEach(e=>{a[e.name]=e.value});for(let e=0;e<t.data.length;e+=4){let d=t.data[e+0],l=t.data[e+1],s=t.data[e+2],h=t.data[e+3];d>=a.rmin&&d<=a.rmax&&l>=a.gmin&&l<=a.gmax&&s>=a.bmin&&s<=a.bmax&&h>200&&(t.data[e+3]=0)}return t},L=t=>{const a=t.target.dataset.filter;g.forEach(e=>{e.classList.remove("active")}),t.target.classList.add("active"),m=a};document.addEventListener("DOMContentLoaded",v);o.addEventListener("canplay",b);f.addEventListener("click",y);g.forEach(t=>{t.addEventListener("click",L)});
